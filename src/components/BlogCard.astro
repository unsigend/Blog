---
import { SITE_BASE } from '@/consts'
import FormattedDate from './FormattedDate.astro'

const { post } = Astro.props

// Category display names
const categoryNames = {
	'algorithm': 'Algorithm',
	'low-level-system': 'Low Level System',
	'software-design': 'Software Design'
}

// Category colors
const categoryColors = {
	'algorithm': 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200',
	'low-level-system': 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200',
	'software-design': 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200'
}

const category = (post.data.category || 'software-design') as keyof typeof categoryNames
// slug already includes category folder, so use it directly
const coverImagePath = `/blogimages/${post.slug}/${post.data.coverImage || 'cover.png'}`
---

<a
	href={`${SITE_BASE}/blog/${post.slug}/`}
	class="flex flex-col gap-4 pb-8 h-full group transition-colors"
>
	<img
		src={coverImagePath}
		alt={post.data.title}
		class="object-cover rounded-xl aspect-video w-full"
		loading="lazy"
	/>
	<div class="flex items-center gap-2">
		<span class={`px-3 py-1 rounded-full text-xs font-semibold ${categoryColors[category]}`}>
			{categoryNames[category]}
		</span>
	</div>
	<h4
		class="text-2xl font-semibold text-foreground dark:text-foreground-dark group-hover:opacity-70 transition-opacity duration-200"
	>
		{post.data.title}
	</h4>
	<p class="line-clamp-3 opacity-80">
		{post.data.description}
	</p>
	<p class="uppercase text-sm mt-auto tracking-tight">
		<FormattedDate date={post.data.pubDate} />
	</p>
</a>
